{% extends 'base.html' %}

{% block content %}
<style>
 table {
  font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
  font-size: 14px;
  background: white;
  max-width: 70%;
  width: 70%;
  border-collapse: collapse;
  text-align: left;
}
th {
  text-align: center;
  font-weight: normal;
  color: #039;
  border-bottom: 2px solid #6678b1;
  padding: 10px 8px;
}
td {
  color: #669;
  padding: 9px 8px;
  transition: .3s linear;
}
tr:hover td {
  color: #6699ff;
}
td {
  text-align: center;
  border-bottom: 1px solid #ccc;
  color: #000;
  padding: 9px 8px;
  transition: .3s linear;
}
</style>
<h3 class="text-center mt-5 mb-5">Ваша карзина {% if not cart.products.count %} пуста {% endif %}</h3>
{% if cart.products.count%}
<table style="align:right; margin: 0 auto;">
    <tr>
{% if messages %}
    {% for message in messages %}
        <div style="margin-left: 280px; " class="alert alert-success alert-dismissible fade show" role="alert">
             <strong> {{ message }}</strong> <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endfor %}
{% endif %}

    </tr>
<tr>
    <th>Наименование</th>
    <th>Изображение</th>
    <th>Цена</th>
    <th>Количество</th>
    <th>Общая цена</th>
    <th scope="col">Действие</th>
</tr>
    {% for item in cart.products.all %}
<tr>
    <td>{{ item.content_object.title }}</td>
    <td class="w-25"><img class="img-fluid" src="{{ item.content_object.image.url }}"></td>
    <td>{{ item.content_object.price }} руб.</td>
    <td>
        <form action="{% url 'change_coll_in_cart' ct_model=item.content_object.get_model_name slug=item.content_object.slug %}" method="POST">
            {% csrf_token %}
            <input min="1" name="coll" type="number" class="form-control" style="width: 70px;" value="{{ item.coll }}">
                <br>
            <input type="submit" class="btn btn-primary" value="Изменить количество" style="font-size:0.5rem;">
        </form>
    </td>
    <td>{{ item.final_price }} руб.</td>
    <td>
        <a href="{% url 'remove_from_cart' ct_model=item.content_object.get_model_name slug=item.content_object.slug %}">
            <botton class="btn btn-danger" style="font-size:0.5rem;">Удалить из корзины</botton></a>
    </td>
</tr>
    {% endfor %}
    <tr>
        <td colspan="2"></td>
        <td>Итого:</td>
        <td>{{ cart.total_products }}</td>
        <td><strong>{{ cart.final_price }} руб.</strong></td>
    </tr>
</table>
{% endif %}
{% endblock %}